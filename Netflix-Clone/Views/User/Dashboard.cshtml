@using Microsoft.AspNetCore.Identity
@using Netflix_Clone.Data
@inject UserManager<User> UserManager
@inject SignInManager<User> SignInManager
@inject IHttpContextAccessor HttpContextAccessor
@model (List<Movie>, List<Show>)

@{
    var user = await UserManager.GetUserAsync(HttpContextAccessor.HttpContext.User);
    var userMovies = user?.Movies;
    var userShows = user?.Shows;
    string GetStatusClass(string status) => status switch
    {
        "COMPLETED" => "completed",
        "CURRENTLY_WATCHING" => "watching",
        "PLAN_TO_WATCH" => "plan",
        "ON_HOLD" => "hold",
        "DROPPED" => "dropped",
        "NOT_INTERESTED" => "notinterested",
        _ => ""
    };
}

<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Home - Movie Tracker</title>
    <link rel="stylesheet" href="/css/styles.css">
</head>
<body>
    <nav class="navbar">
        <div class="logo">MovieTracker</div>
        <ul class="nav-links">
            <li><a href="/Genres">Genres</a></li>
            <li><a href="/Movies">Movies</a></li>
            <li><a href="/Shows">Shows</a></li>
        </ul>
        <form method="get" action="/Search" class="search-form">
            <input type="text" name="q" placeholder="Search..." />
            <button type="submit">Search</button>
        </form>
    </nav>

    <main class="content">
        <section class="media-section">
            <h2>Your Movies</h2>
            <div class="media-grid">
                @foreach (var movie in userMovies)
                {
                    <div class="media-card @GetStatusClass(movie.Status.ToString())">
                        <h3>@movie.Movie.Title</h3>
                        <p>Status: @movie.Status</p>
                    </div>
                }
            </div>
        </section>

        <section class="media-section">
            <h2>Your Shows</h2>
            <div class="media-grid">
                @foreach (var show in userShows)
                {
                    <div class="media-card @GetStatusClass(show.Status.ToString())">
                        <h3>@show.Show.Title</h3>
                        <p>Status: @show.Status</p>
                    </div>
                }
            </div>
        </section>
    </main>
</body>
</html>
